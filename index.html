<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NightGear Workshop</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Rajdhani:wght@500;700&family=Lato:wght@400;700;900&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- CORE THEME --- */
        :root {
            --bg-dark: #050505; --accent-blue: #0077ff; --glow-blue: #00ccff;
            --accent-gold: #e6b800; --accent-red: #ff3333; --text-main: #f0f0f0; --border: #1f293a;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at 50% 0%, #0d121c 0%, #000 70%);
            color: var(--text-main); font-family: 'Lato', sans-serif; min-height: 100vh; padding-bottom: 60px;
        }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; display: flex; flex-direction: column; min-height: 100vh; }
        
        /* HEADER */
        header { display: flex; justify-content: space-between; align-items: center; margin: 20px 0 30px 0; border-bottom: 1px solid #222; padding-bottom: 20px; }
        .logo h1 { 
            background: linear-gradient(to right, #fff, var(--glow-blue)); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; font-family: 'Cinzel', serif; font-size: 1.6rem; cursor: pointer;
        }
        .user-badge { font-family: 'Rajdhani', sans-serif; font-weight: bold; border: 1px solid var(--accent-gold); color: var(--accent-gold); padding: 5px 12px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; }
        .login-btn { font-family: 'Rajdhani', sans-serif; border: 1px solid #444; color: #aaa; padding: 5px 12px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; }
        
        /* --- MOD CARDS --- */
        .mod-card {
            background: #0d121c; border: 1px solid var(--border); border-radius: 12px;
            padding: 20px; margin-bottom: 20px; position: relative; overflow: hidden; transition: 0.3s;
        }
        .mod-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .mod-title { font-size: 1.1rem; color: #fff; font-weight: 900; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 0.5px; }
        
        .badge { font-size: 0.6rem; padding: 3px 6px; border-radius: 3px; font-weight: bold; letter-spacing: 1px; }
        .b-free { background: rgba(0, 119, 255, 0.1); color: var(--glow-blue); border: 1px solid var(--accent-blue); }
        .b-prem { background: rgba(230, 184, 0, 0.1); color: var(--accent-gold); border: 1px solid var(--accent-gold); }
        .b-admin { background: #330000; color: var(--accent-red); border: 1px solid var(--accent-red); }

        .mod-desc { font-size: 0.9rem; color: #ccc; line-height: 1.6; }
        .ui-btn { display: inline-block; background: #222; border: 1px solid #555; color: #fff; padding: 0px 6px; border-radius: 4px; font-size: 0.75rem; font-family: monospace; box-shadow: 0 2px 0 #000; margin: 0 2px; }
        .txt-gold { color: var(--accent-gold); font-weight: bold; }
        .txt-red { color: var(--accent-red); font-weight: bold; }
        .txt-code { background: #000; color: #0f0; font-family: monospace; padding: 2px 5px; border-radius: 3px; border: 1px solid #333; }

        /* LOCKED STATE */
        .mod-card.locked { background: #080a0f; border-color: #222; opacity: 1; }
        .mod-card.locked .mod-desc, .mod-card.locked .btn-download, .mod-card.locked .donation-box { display: none !important; }
        .lock-container { border: 1px dashed var(--accent-gold); background: rgba(230, 184, 0, 0.05); padding: 20px; text-align: center; border-radius: 8px; margin-top: 10px; }
        .lock-icon { font-size: 1.5rem; color: var(--accent-gold); margin-bottom: 10px; }
        .lock-text { color: #888; font-size: 0.8rem; margin-bottom: 10px; }
        .btn-unlock { background: #111; color: var(--accent-gold); border: 1px solid var(--accent-gold); padding: 5px 15px; cursor: pointer; font-size: 0.8rem; font-weight: bold; }

        /* HAZARD STYLE */
        .mod-card.hazard { background: repeating-linear-gradient(45deg, #1a0505, #1a0505 10px, #2b0000 10px, #2b0000 20px); border: 1px solid var(--accent-red); }
        .mod-card.hazard .mod-title { color: var(--accent-red); text-shadow: 0 0 5px red; }
        
        .btn-download {
            background: var(--text-main); color: #000; display: block; width: 100%;
            padding: 12px; text-align: center; border-radius: 6px; text-decoration: none;
            font-weight: 800; font-family: 'Rajdhani', sans-serif; margin-top: 15px; letter-spacing: 1px; transition: 0.2s;
        }
        .btn-download:hover { background: var(--glow-blue); box-shadow: 0 0 15px var(--glow-blue); }
        .donation-box { margin-top: 15px; background: rgba(197, 160, 89, 0.05); border: 1px dashed var(--accent-gold); padding: 12px; border-radius: 8px; text-align: center; }
        .copy-cmd { background: #000; color: #4ade80; font-family: monospace; padding: 8px; border-radius: 4px; cursor: pointer; display: block; border: 1px solid #333; margin-top: 5px; }

        .grid-menu { display: grid; gap: 12px; }
        .card-menu {
            background: rgba(15, 20, 30, 0.8); border: 1px solid var(--border);
            padding: 18px; border-radius: 10px; display: flex; align-items: center; gap: 15px;
            cursor: pointer; transition: 0.2s;
        }
        .card-menu:hover { border-color: var(--glow-blue); background: rgba(0, 119, 255, 0.08); transform: translateX(5px); }

        /* --- ADMIN PANEL CSS (DESKTOP DEFAULT) --- */
        #admin-panel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #080808; z-index: 9999; display: none;
            overflow: hidden; font-family: 'Lato', sans-serif;
        }
        .adm-layout { display: grid; grid-template-columns: 380px 1fr; height: 100%; }
        
        .adm-sidebar { background: #0c0c0c; border-right: 1px solid #222; display: flex; flex-direction: column; height: 100vh; }
        .adm-header { padding: 20px; border-bottom: 1px solid #222; text-align: center; background: #050505; }
        .adm-header h2 { font-family: 'Cinzel', serif; color: var(--accent-gold); font-size: 1.2rem; }
        .adm-form-scroll { padding: 20px; overflow-y: auto; flex: 1; }
        .form-section { margin-bottom: 25px; border: 1px solid #222; padding: 15px; border-radius: 8px; background: #111; }
        .form-legend { font-size: 0.7rem; color: #666; font-weight: bold; text-transform: uppercase; margin-bottom: 10px; display: block; letter-spacing: 1px; }
        
        .adm-label { display: block; font-size: 0.75rem; color: #888; margin-bottom: 5px; font-weight: bold; }
        .adm-input, .adm-select, .adm-textarea {
            width: 100%; background: #000; border: 1px solid #333; color: #eee; padding: 10px; border-radius: 4px; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; margin-bottom: 10px;
        }
        .adm-input:focus, .adm-textarea:focus { border-color: var(--accent-blue); outline: none; }
        .toolbar { display: flex; gap: 5px; margin-bottom: 5px; flex-wrap: wrap; }
        .tool-btn { background: #222; color: #ccc; border: 1px solid #333; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.7rem; }
        .adm-actions { padding: 20px; border-top: 1px solid #222; background: #050505; display: flex; gap: 10px; }
        .btn-save { flex: 2; background: var(--accent-gold); color: #000; border: none; padding: 12px; font-weight: bold; cursor: pointer; border-radius: 4px; }
        .btn-reset { flex: 1; background: #222; color: #fff; border: 1px solid #333; cursor: pointer; border-radius: 4px; }

        .adm-content { background: #080808; display: flex; flex-direction: column; height: 100vh; }
        .db-header { padding: 20px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; background: #050505; }
        .db-search { background: #111; border: 1px solid #333; color: #fff; padding: 8px 15px; border-radius: 4px; width: 300px; }
        .db-list { flex: 1; overflow-y: auto; padding: 20px; }
        
        /* DATABASE ROW (Desktop) */
        .db-row { 
            display: grid; grid-template-columns: 30px 2fr 1fr 1fr 1fr 100px; 
            align-items: center; background: #111; border: 1px solid #222; 
            padding: 10px; margin-bottom: 8px; border-radius: 4px; font-size: 0.85rem; transition: 0.2s;
        }
        .db-row:hover { border-color: #444; background: #161616; }
        .db-head { font-weight: bold; color: #666; background: transparent; border: none; margin-bottom: 10px; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
        .s-free { background: var(--accent-blue); }
        .s-prem { background: var(--accent-gold); }
        .s-adm { background: var(--accent-red); }
        .row-actions button { background: none; border: none; cursor: pointer; font-size: 0.9rem; margin-left: 10px; }
        .act-edit { color: var(--accent-blue); }
        .act-del { color: var(--accent-red); }

        /* --- MOBILE RESPONSIVE TWEAKS --- */
        @media (max-width: 900px) {
            /* 1. Layout Stack Vertical */
            .adm-layout {
                display: block; /* Hapus Grid */
                overflow-y: auto; /* Scroll halaman */
            }
            #admin-panel { overflow-y: auto; } /* Scroll container utama */
            
            /* 2. Sidebar (Editor) */
            .adm-sidebar {
                width: 100%; height: auto; border-right: none; border-bottom: 1px solid #222;
                max-height: none; /* Biarkan memanjang */
            }
            .adm-form-scroll { padding: 15px; }
            .adm-actions { position: relative; bottom: 0; }

            /* 3. Content (Database) */
            .adm-content { width: 100%; height: auto; overflow: visible; padding-bottom: 50px; }
            .db-header { flex-direction: column; gap: 10px; align-items: stretch; }
            .db-search { width: 100%; }

            /* 4. Database Table Mobile Transform */
            .db-head { display: none; } /* Sembunyikan Header */
            .db-row {
                grid-template-columns: 1fr auto; /* Nama di kiri, Aksi di kanan */
                grid-template-rows: auto auto; /* Baris 1: Judul, Baris 2: Details */
                gap: 5px; padding: 15px;
            }
            /* Kolom 1 (#) Sembunyi */
            .db-row div:nth-child(1) { display: none; }
            /* Kolom 2 (Judul) Full Width di baris 1 */
            .db-row div:nth-child(2) { grid-column: 1 / 2; font-size: 1rem; color: #fff; }
            /* Kolom 3,4,5 (Game, Cat, Type) Gabung di baris 2 */
            .db-row div:nth-child(3), .db-row div:nth-child(4), .db-row div:nth-child(5) {
                display: inline-block; font-size: 0.75rem; color: #888; margin-right: 10px;
            }
            /* Kolom 6 (Aksi) di Kanan Atas */
            .db-row div:nth-child(6) { grid-column: 2 / 3; grid-row: 1 / 3; align-self: center; justify-self: end; }
            
            .row-actions button { margin-left: 15px; font-size: 1.2rem; }
        }

        /* UTILS & AUTH */
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .auth-box { background: #0b101a; border: 1px solid #222; padding: 30px; border-radius: 15px; max-width: 400px; margin: 40px auto; }
        #toast-container { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10000; }
        .toast { background: rgba(10,10,10,0.95); border: 1px solid var(--accent-gold); color: #fff; padding: 12px 25px; border-radius: 50px; margin-top: 10px; opacity: 0; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
        .toast.error { border-color: var(--accent-red); color: var(--accent-red); }
        .toast.show { opacity: 1; transform: translateY(0); }

    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="admin-panel">
        <div class="adm-layout">
            <div class="adm-sidebar">
                <div class="adm-header">
                    <h2>NIGHTGEAR ADMIN</h2>
                </div>
                <div class="adm-form-scroll">
                    <input type="hidden" id="edit-id">

                    <div class="form-section">
                        <span class="form-legend">Informasi Dasar</span>
                        <label class="adm-label">Nama Modul</label>
                        <input type="text" id="adm-title" class="adm-input" placeholder="Contoh: Dark UI v1">
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label class="adm-label">Target Game</label>
                                <input type="text" id="adm-game" class="adm-input" placeholder="TibiaME">
                            </div>
                            <div>
                                <label class="adm-label">Kategori</label>
                                <input type="text" id="adm-cat" class="adm-input" placeholder="OTME">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <span class="form-legend">Klasifikasi & Konten</span>
                        <label class="adm-label">Tipe Akses</label>
                        <select id="adm-type" class="adm-select">
                            <option value="FREE">FREE (Publik)</option>
                            <option value="PREMIUM">PREMIUM (Member)</option>
                            <option value="ADMIN">ADMIN (Hazard)</option>
                        </select>

                        <label class="adm-label" style="margin-top:10px;">Deskripsi</label>
                        <div class="toolbar">
                            <button class="tool-btn" onclick="insertTag('[btn]', '[/btn]')">BTN</button>
                            <button class="tool-btn" onclick="insertTag('[gold]', '[/gold]')">GOLD</button>
                            <button class="tool-btn" onclick="insertTag('[red]', '[/red]')">RED</button>
                            <button class="tool-btn" onclick="insertTag('[code]', '[/code]')">CODE</button>
                        </div>
                        <textarea id="adm-desc" class="adm-textarea" rows="4"></textarea>

                        <label class="adm-label">Link Download</label>
                        <input type="text" id="adm-link" class="adm-input" placeholder="URL...">
                    </div>
                </div>
                <div class="adm-actions">
                    <button class="btn-reset" onclick="resetForm()">BATAL</button>
                    <button class="btn-save" id="btn-submit" onclick="saveMod()">SIMPAN DATA</button>
                </div>
            </div>

            <div class="adm-content">
                <div class="db-header">
                    <h3 style="color:#fff; font-size:1rem;">DATABASE MANAGEMENT</h3>
                    <div style="display:flex; gap:10px; width:100%; justify-content:flex-end;">
                        <input type="text" id="search-mod" class="db-search" placeholder="Cari Modul..." onkeyup="renderAdminList()">
                        <button onclick="logout()" style="background:#220000; color:red; border:1px solid red; padding:5px 15px; border-radius:4px; cursor:pointer;">LOGOUT</button>
                    </div>
                </div>
                <div class="db-list">
                    <div class="db-row db-head">
                        <div>#</div>
                        <div>NAMA MOD</div>
                        <div>GAME</div>
                        <div>KAT</div>
                        <div>TIPE</div>
                        <div style="text-align:right">AKSI</div>
                    </div>
                    <div id="admin-list-container">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="main-view">
        <header>
            <div class="logo"><h1>NIGHTGEAR</h1></div>
            <div id="header-user"></div>
        </header>

        <div id="p-home" class="page active">
            <h3 style="color:#666; font-size:0.8rem; margin-bottom:15px; letter-spacing:1px;">AVAILABLE GAMES</h3>
            <div class="grid-menu" id="game-list"></div>
        </div>

        <div id="p-cats" class="page">
            <button class="btn-back" onclick="nav('p-home')" style="background:none; border:none; color:#888; cursor:pointer; margin-bottom:20px;"><i class="fa-solid fa-arrow-left"></i> BACK TO GAMES</button>
            <h2 id="cat-title" style="color:var(--glow-blue); margin-bottom:20px; text-transform:uppercase;">GAME</h2>
            <div class="grid-menu" id="cat-list"></div>
        </div>

        <div id="p-mods" class="page">
            <button class="btn-back" onclick="nav('p-cats')" style="background:none; border:none; color:#888; cursor:pointer; margin-bottom:20px;"><i class="fa-solid fa-arrow-left"></i> BACK TO CATEGORY</button>
            <h2 id="mod-title-header" style="color:var(--accent-gold); margin-bottom:20px; text-transform:uppercase;">MODS</h2>
            <div id="mods-container"></div>
        </div>

        <div id="p-login" class="page">
            <button class="btn-back" onclick="nav('p-home')" style="background:none; border:none; color:#888; cursor:pointer; margin-bottom:20px;">Home</button>
            <div class="auth-box">
                <h2 style="text-align:center; color:var(--accent-gold); margin-bottom:20px;">SYSTEM LOGIN</h2>
                <input type="text" id="log-id" class="adm-input" placeholder="Identity" style="margin-bottom:10px;">
                <input type="password" id="log-pass" class="adm-input" placeholder="Passcode" style="margin-bottom:20px;">
                <button onclick="login()" style="width:100%; background:var(--accent-gold); color:#000; border:none; padding:12px; font-weight:bold; border-radius:5px; cursor:pointer;">ACCESS</button>
                <p style="text-align:center; margin-top:20px; font-size:0.8rem; color:var(--accent-blue); cursor:pointer;" onclick="nav('p-register')">>> Request Premium Access</p>
            </div>
        </div>

        <div id="p-register" class="page">
            <button class="btn-back" onclick="nav('p-login')" style="background:none; border:none; color:#888; cursor:pointer; margin-bottom:20px;">Login</button>
            <div class="auth-box">
                <h2 style="text-align:center; color:var(--accent-blue); margin-bottom:10px;">NEW MEMBER</h2>
                <p style="text-align:center; color:#666; font-size:0.8rem; margin-bottom:20px;">Fee: 5.000.000 Gold (OTME)</p>
                <input type="text" id="reg-u" class="adm-input" placeholder="Username">
                <button onclick="register()" style="width:100%; background:var(--accent-blue); color:#fff; border:none; padding:12px; font-weight:bold; border-radius:5px; cursor:pointer; margin-top:15px;">SUBMIT VIA WHATSAPP</button>
            </div>
        </div>
    </div>

    <script>
        // DATA
        const initialData = [
            { id: 1, game: 'TibiaME', cat: 'OTME', title: 'NightGear UI v4', type: 'FREE', desc: 'New [btn]Analog[/btn] Control with [blue]Blue Neon[/blue] theme.', link: '#' },
            { id: 2, game: 'TibiaME', cat: 'Official', title: 'Playstore Client', type: 'FREE', desc: 'Original CipSoft Client.', link: 'https://play.google.com/store/apps/details?id=com.cipsoft.tibiame' },
            { id: 3, game: 'TibiaME', cat: 'OTME', title: 'Gold VIP Edition', type: 'PREMIUM', desc: 'Exclusive [gold]Gold HUD[/gold] + Auto Login.', link: '#' },
            { id: 4, game: 'Private', cat: 'Dev', title: 'SERVER CORE DUMP', type: 'ADMIN', desc: 'Database access credentials.', link: '#' }
        ];

        let mods = JSON.parse(localStorage.getItem('ng_mods_v51')) || initialData;
        let user = JSON.parse(localStorage.getItem('ng_user_v51')) || { role: 'guest' };
        let currentGame = null;

        // RENDER LOGIC
        function renderGames() {
            const list = document.getElementById('game-list');
            list.innerHTML = '';
            const games = [...new Set(mods.map(m => m.game))];
            games.forEach(g => {
                list.innerHTML += `<div class="card-menu" onclick="selectGame('${g}')">
                    <div class="card-icon"><i class="fa-solid fa-gamepad"></i></div>
                    <div><h3 style="color:#fff; text-transform:uppercase;">${g}</h3><p style="color:#666; font-size:0.8rem">Browse Mods</p></div>
                    <i class="fa-solid fa-chevron-right" style="margin-left:auto; color:#444"></i>
                </div>`;
            });
        }

        function selectGame(g) {
            currentGame = g;
            document.getElementById('cat-title').innerText = g;
            const list = document.getElementById('cat-list');
            list.innerHTML = '';
            const gMods = mods.filter(m => m.game === g);
            const cats = [...new Set(gMods.map(m => m.cat))];
            cats.forEach(c => {
                let icon = c.toLowerCase().includes('official') ? 'fa-google-play' : 'fa-folder';
                list.innerHTML += `<div class="card-menu" onclick="selectCat('${c}')">
                    <div class="card-icon"><i class="fa-solid ${icon}"></i></div><h3 style="color:#fff;">${c}</h3>
                    <i class="fa-solid fa-chevron-right" style="margin-left:auto; color:#444"></i>
                </div>`;
            });
            nav('p-cats');
        }

        function selectCat(c) {
            document.getElementById('mod-title-header').innerText = c;
            const container = document.getElementById('mods-container');
            container.innerHTML = '';
            const items = mods.filter(m => m.game === currentGame && m.cat === c);

            items.forEach(m => {
                const isAdminItem = m.type === 'ADMIN';
                const isPremium = m.type === 'PREMIUM';
                const isLocked = (isPremium && user.role === 'guest');
                
                let cardClass = 'mod-card';
                let contentHTML = '';

                // PARSE DESCRIPTION TAGS
                let desc = m.desc
                    .replace(/\[btn\](.*?)\[\/btn\]/g, '<span class="ui-btn">$1</span>')
                    .replace(/\[gold\](.*?)\[\/gold\]/g, '<span class="txt-gold">$1</span>')
                    .replace(/\[red\](.*?)\[\/red\]/g, '<span class="txt-red">$1</span>')
                    .replace(/\[blue\](.*?)\[\/blue\]/g, '<span style="color:var(--glow-blue); font-weight:bold">$1</span>');

                if (isAdminItem) {
                    cardClass += ' hazard';
                    if (user.role !== 'admin') {
                        contentHTML = `<div style="position:absolute; top:0; left:0; width:100%; height:100%; cursor:not-allowed; z-index:10;" onclick="hazardTrigger()"></div>
                                       <div class="mod-desc" style="color:#500; font-family:monospace;">[ENCRYPTED DATA] LEVEL 5 CLEARANCE REQUIRED.</div>`;
                    } else {
                        contentHTML = `<div class="mod-desc">${desc}</div><a href="${m.link}" class="btn-download" style="background:var(--accent-red); color:#fff;">SECURE DOWNLOAD</a>`;
                    }
                } 
                else if (isLocked) {
                    // --- LOCKED LOGIC (SHOW NAME, HIDE DESC) ---
                    cardClass += ' locked';
                    contentHTML = `
                    <div class="lock-container">
                        <i class="fa-solid fa-lock lock-icon"></i>
                        <div class="lock-text">MEMBER ONLY CONTENT</div>
                        <button class="btn-unlock" onclick="nav('p-login')">UNLOCK ACCESS</button>
                    </div>`;
                } 
                else {
                    // NORMAL
                    contentHTML = `
                    <div class="mod-desc">${desc}</div>
                    <a href="${m.link}" class="btn-download">DOWNLOAD MOD</a>
                    <div class="donation-box">
                        <div style="font-size:0.8rem; color:#aaa; font-style:italic; margin-bottom:5px;">"Your support keeps the gears turning."</div>
                        <span class="copy-cmd" onclick="copyTg()">.tg nightgear</span>
                    </div>`;
                }

                let badgeClass = m.type==='FREE'?'b-free':(m.type==='PREMIUM'?'b-prem':'b-admin');

                container.innerHTML += `
                <div class="${cardClass}">
                    <div class="mod-header">
                        <div class="mod-title">${m.title}</div>
                        <span class="badge ${badgeClass}">${m.type}</span>
                    </div>
                    ${contentHTML}
                </div>`;
            });
            nav('p-mods');
        }

        function hazardTrigger() {
            if(navigator.vibrate) navigator.vibrate([100]);
            showToast('ACCESS DENIED!', 'error');
        }

        // --- ADMIN SYSTEM ---
        function login() {
            const u = document.getElementById('log-id').value;
            const p = document.getElementById('log-pass').value;
            if(u === 'Zikra' && p === 'LightGear76') {
                user = { role: 'admin', name: 'Zikra' }; saveUser(); openAdmin();
            } else if(u === 'member' && p === 'member') {
                user = { role: 'member', name: 'Demo' }; saveUser(); nav('p-home'); showToast('Welcome Member!', 'success');
            } else { showToast('Access Denied', 'error'); }
        }

        function register() {
            const u = document.getElementById('reg-u').value;
            if(!u) return showToast('Isi Username!', 'error');
            window.open(`https://wa.me/6283101456267?text=Reg Member: ${u}`, '_blank');
        }

        function openAdmin() { document.getElementById('admin-panel').style.display = 'block'; document.getElementById('main-view').style.display = 'none'; renderAdminList(); }
        
        function renderAdminList() {
            const c = document.getElementById('admin-list-container');
            const term = document.getElementById('search-mod').value.toLowerCase();
            c.innerHTML = '';
            mods.forEach((m) => {
                if(!m.title.toLowerCase().includes(term)) return;
                let dot = m.type==='FREE'?'s-free':(m.type==='PREMIUM'?'s-prem':'s-adm');
                c.innerHTML += `
                <div class="db-row">
                    <div class="status-dot ${dot}"></div>
                    <div style="color:#fff; font-weight:bold;">${m.title}</div>
                    <div style="color:#888;">${m.game}</div>
                    <div style="color:#888;">${m.cat}</div>
                    <div style="color:#ccc;">${m.type}</div>
                    <div class="row-actions">
                        <button class="act-edit" onclick="editMod(${m.id})"><i class="fa-solid fa-pen"></i></button>
                        <button class="act-del" onclick="delMod(${m.id})"><i class="fa-solid fa-trash"></i></button>
                    </div>
                </div>`;
            });
        }

        function saveMod() {
            const id = document.getElementById('edit-id').value;
            const game = document.getElementById('adm-game').value;
            const cat = document.getElementById('adm-cat').value;
            const title = document.getElementById('adm-title').value;
            const type = document.getElementById('adm-type').value;
            const desc = document.getElementById('adm-desc').value;
            const link = document.getElementById('adm-link').value;

            if(!game || !title) return showToast('Data Incomplete', 'error');

            if (id) {
                const index = mods.findIndex(m => m.id == id);
                mods[index] = { id: parseInt(id), game, cat, title, type, desc, link };
            } else {
                mods.push({ id: Date.now(), game, cat, title, type, desc, link });
            }
            localStorage.setItem('ng_mods_v51', JSON.stringify(mods));
            resetForm(); renderAdminList(); showToast('Data Saved');
        }

        function editMod(id) {
            const m = mods.find(m => m.id == id);
            document.getElementById('edit-id').value = m.id;
            document.getElementById('adm-game').value = m.game;
            document.getElementById('adm-cat').value = m.cat;
            document.getElementById('adm-title').value = m.title;
            document.getElementById('adm-type').value = m.type;
            document.getElementById('adm-desc').value = m.desc;
            document.getElementById('adm-link').value = m.link;
            document.getElementById('btn-submit').innerText = "UPDATE";
            document.getElementById('btn-submit').style.background = "var(--accent-gold)";
        }

        function delMod(id) {
            if(confirm('Delete?')) {
                mods = mods.filter(m => m.id !== id);
                localStorage.setItem('ng_mods_v51', JSON.stringify(mods));
                renderAdminList();
            }
        }

        function resetForm() {
            document.getElementById('edit-id').value = '';
            document.getElementById('adm-game').value = '';
            document.getElementById('adm-title').value = '';
            document.getElementById('adm-desc').value = '';
            document.getElementById('adm-link').value = '';
            document.getElementById('btn-submit').innerText = "PUBLISH";
            document.getElementById('btn-submit').style.background = "var(--accent-blue)";
        }

        function insertTag(s, e) {
            const el = document.getElementById('adm-desc');
            el.value += s + 'text' + e;
        }

        // UTILS
        function logout() { user = { role: 'guest' }; saveUser(); location.reload(); }
        function saveUser() { localStorage.setItem('ng_user_v51', JSON.stringify(user)); updateUserUI(); }
        function updateUserUI() {
            const p = document.getElementById('header-user');
            if(user.role === 'guest') p.innerHTML = `<span class="login-btn" onclick="nav('p-login')"><i class="fa-solid fa-user"></i> LOGIN</span>`;
            else p.innerHTML = `<span class="user-badge" onclick="logout()"><i class="fa-solid fa-crown"></i> ${user.name}</span>`;
        }
        function nav(id) {
            window.scrollTo(0,0); document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }
        function showToast(m, t) {
            const d = document.createElement('div'); d.className = `toast show ${t==='error'?'error':''}`;
            d.innerHTML = `<i class="fa-solid ${t==='error'?'fa-triangle-exclamation':'fa-check-circle'}"></i> ${m}`;
            document.getElementById('toast-container').appendChild(d); setTimeout(()=>d.remove(), 3000);
        }
        function copyTg() { navigator.clipboard.writeText('.tg nightgear'); showToast('Command Copied!'); }

        updateUserUI(); renderGames();
        if(user.role === 'admin') openAdmin();

    </script>
</body>
</html>
